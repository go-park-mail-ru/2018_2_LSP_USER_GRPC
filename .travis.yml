language: go
go:
- 1.11
before_script:
- sudo apt-get install -qq sshpass
script: 
after_success:
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST rm -r ~/server/user-grpc/*
- sshpass -p $SSH_PASS scp -rp -o stricthostkeychecking=no * $SSH_USER@$SSH_HOST:~/server/user-grpc
- sshpass -p $SSH_PASS ssh -o StrictHostKeyChecking=no $SSH_USER@$SSH_HOST docker
  build -t user-grpc-server ~/server/user-grpc ; docker stop user-grpc ; docker
  run -e "DB_HOST=postgres" -e "DB_USER=$DB_USER" -e "JWT_TOKEN=$JWT_TOKEN" -e "DB_PASS=$DB_PASS"
  -e "DB_DB=$DB_DB" -d --link postgres:postgres --name user-grpc --rm --publish 32001:8080
  user-grpc-server
env:
  global:
  - secure: PArvEM6oq3lW+CN1c6pEgke3RVu1yGiXggy3ZPByWiYvYdKHO/0J3L4su6xSFS2ObtV1y0ZOU1SMWivUehqevygAjBp0ANmt/Dr/ypcJkIYU8tYef+0o26dIGGWi5HfxEGmjFXgwrk/TcHSU3e/rfQFviuSR9iZTbL74STqCoQvUkfCrY2xuM9AYudeC4uYcCHPVdU/I3bFkKA2nhBHW7ZsT390mocj4BbAvZd+dO1Td0d6moWOM6REN6FG5ltIPbZ5c1rr5QzS4VoEU9c38i7gdq7KzlvZHjjxadMGSB1Hu/QzRJ98Efusspzy9PvVCT3lxNzfo2QUY/MgxGyvzIzn0ix/1kEzqDaxOGDZ8I/b35MOug1klMUV8M0gx8SJswDk2dhkdDYdIxCQzV//jJtzcxyMc9a6RXCaXnYgGRKO0og+QFdJzljgbmjRH8FfnjTczgIldgQsY8iC0m/h9IbHOV2pIv4thjbbp6TPgXBAdlQ4ZK27eTbGA302WVzAQ7eGH54UCP00357JJll2tV5q1xA01e44E+4PxBnNcWBZo2GDKzUwJheF0jtl6LcvYSast11+Jci3pktmWQZJdXilpbekID7IUL0OGjji+C51KW71kISHW718M+hED+dXSiVjDTlEOzd6mya0DEBOUmXbMuY7l3QlWd51IRdgb8KY=
  - secure: hcnYBot9ULufZMUsApiht3apnxr1ZG9Us0PJVcXkYNy+mZzJfGk3CMoJ8GUfWg2UhVYMtdGf5Q4yRKZVO053SQcvZHDdTC79qwr+Vq1ekwa41BtycaenTGaV0mZj6d0rqLaC5oMVe/1YVNVEEsqnqme9l/ipHathR/DaeRd4B+UmcIoVFpZbriC9wPc58bGXRKrRx7Z/4qAkUnWTJSwBFLbiRoBXjQf7rAme5T+lH++QTzIYRNeIPcSVUvqcx60Hk/T7UXr8Mhj5qV/nwI+evFXgJ4hBp54YbICojxoYRetrnbgfkGBq1L5e+KN7YcvQV/+LfsuYUYZPxVE7RJUiwLpPfqJdp3GPAM9ARInjkXLximyCKVaMu+zXc8pSF7qj3JbLJhvBuY+6phvAXYy+ml7vRCUAyEBPex6R+o2Mpnz86aEpGl8I9XwjaKq/ejmSo/qTiWZGcRakJPMOCgd16BZzLoqdcDz6npdM69krlTr66zVZLiyDO2pQ1TwezKAWddv/mNJVNqYOXSDiZWE49UWmOPJbyYQRxw4ZYfZsUYGiApMvjvHUx83PE//e9tCiYBJsz/k6k/vw15jr/CNb9HBO3hk0FW5i2homdMSGou9hoIBuBv4hNwBKB3ls6QS773i4Z9RVU4wq6OjR9FLjg+odJWbjs5Eq3Rf8NaXD5u4=
  - secure: CFBlmY5kkzXlyp563dU7fLf46si52f7O8Gyr7G16y0rDrM4urUM42tgQobzGfoYIRssy5tsSIzkCT6ecjOt9HkjHe8/mCsGyakq9+mwzBtL0uEDh1P8AwxLituo2QgTvtnpXLruwI04cYCKTwXd9quzTrwrxxXDW8WCn/wp3p/yaw7ZEqOmTvS2OVPIt8OSFBWKLKwsEn8b+suo8e0kDJDx5e+P90NK9wpvge/r8KUZNWIlc16oie/oNOcbJaBvyOhFLLiVuBxZFYOw/tuxi+EeZ+6AgT2TlWmStQ7iUHb93YYepRx2WO7iSk0uv1PThVU2htXRmnRcy8armzEsVuVlsI3AAQ1pKub3tpfshcSi+xfmRot52g/VUDKlZoPWBlpSCedzLSfSKxWkHaQLsq+b6RSpDzf28MhbP2JvwUrWezpjXMeNTLNrWUcwd6PLBiccqNKx8trNgJM4FM2TXOzgAw3ro/jHG2+Ymx8rrm/6RjbW9p0MDya3GuOSR71173+maM53X/nfBg0GTO6Z5boP3iq87aqVl67pGerF+KJtRNadgPtG/5jIQK8ewbcg0ybxzzRz0nMyoOQv2rr/ogSCN3k2kTlOd+rwu/qgxlU2rgjWCRQVyA2SNeUmRhH40PtYV2y5LzuvqRnmo4qX85vm8s0AHDlCN2omgTVfmLno=
  - secure: ABwDx8dsogUzG1vbC0dF7jaHj081POHYhcTcvwwoYWP32zr9ggr5fxSLMRErkvaZRz4auELAtd5or/y7H7I9q6KQF4kwkJPUbfP6qFrP6B+fqakU1SRARt2BVWen79micUegkUjX/qyJkpQlvAQtbGqNqCz1QzIljJO/MznmrZXd+9CyeGCfaf7s+kAA3EJdvBacS+otmhp8Jsx3qHKzz7m8qU7spYHpqErubdmPeiG+hREcMDxetQRr3ScH7Ik17+4dd+rQGzp0ycST87/YxExtzDPnmyu7bE5V3m0bnisqwvMFcaAj1gzheQHnx89UFDI3pnsc3U+LizAE/os2GS3lzcVt+976vR0xxEtMzpXSbPKsnPbhdwS2gd9CRFdlH5WHxL/JU8OP/4TTWKa1jrXPPhuM2Xkcmt1RmOttF6mSXCDoctvncy7KO4GW+HdQ8zAeyhxXCrKbzz/2Cp6xfsUbu036uvM/l7seCZ839LJ245u4mIdNoenJ/Bza8of5dIuua6YOdtFHGOOfxQnLNkvXjcjw6HqeQNZSkfs3yqAVSiU3TxdNopCIcrwb+faVV4mGOE1ZLD6e1f/fdb/5c9tyloPhKYxUHz0UxfTm8cNgP7b9tPud1Bd26Scxk7uci10yZ2o9Yp/gif5anoh9nB7BDOz+n0JXmWE10TskTkc=
  - secure: NlmLcWz21u00KMlbX+bTDqD6cHXTojjJ7mMsYtEHPr1dqdn9Vf1ElrFuxKyodAr2ZyKYb0ZApe0AYL3XGBSVSP6shKJNMpnBXQjYI1ektfOQHz3VclpGbFy8bUtLquHwyHWjH+gCdl2BxPx6XRI3jV4WdmvgqW5H3L3VpMc/lEk8R/H0bjfmETr9N6/PThrD7LdP5kgGWATWY8qnOmbOawHA+MBNgoGX1kNBzoUhH8HF0Zac1BaQTqgbCPt7+7178a0RLQWsj/loTXCDWJdaccFjP5GJm0xUMamBHQ35iVC4z0HiQwFqXgHN1iPMYEyqci3s7PnDCokoo7PhZiWEe1kTgeiSXimHwLLRn2U9FkqpehDFqEtmD0n4ESQJmw2BQc1G9jH2VnouVVoeVEKFSTqo9tybFbFYVDrRPTqosfnzTnzxf1R3492qSUW7eWDMlDiVAyuF7B7V4S2r4hkveHCJFvimMD1GH/myzwsito66oXLtlTBgtoegzMKFZDMfpVEITSqGgIDjRAfnwmOCfALdellbK8uMaqiOEYK6WqtKVWMzPTeagoAd+jbmNFdBOut213s9ytPv0GntdiKB0hUgv5im1NuwsynUxZDDGbE09u3/pxKML8Gk0tn5jQ2F0jYVfK1+WNtKSw8ishLYb0/zBkIrCPyIVq6foTzf8a8=
  - secure: FWvBzYmRfyKJ0KPtqVfImq2iqaV1GHPmRv3i/9hqs4kGcQECcAy7oWq5F7HYv7QFSg93ASS8m1j4Q6ivmxAtMOFl0chWxYLkG9fFfJtC4cdpv/cqxmRTUb28PELk4LhHW0eR4JGO5g9X4Vuw/s1bFQokgkuYdxkMEr5CyT12aAOaksfHrr2Qx41eEZF2MzSrPtzytA/kx9k2YmUSef/TRkB8/QOz8mDZcuFF7FZEs0z+M9jLQyIfAQk4gJXtA968MF6aZDjYM0VOOfrh9aStCbkORiDXj6kSHe983O9U2iRJolK92MSGV/rZA3b/mjIFVrfOkulpMSdUvQ7PnUfyCs5uTUgQWyXZi6h6CiSLrI2jhiVjBmhf3RIHUkF51T4NYHwAOakBxmJTj2LidTINHiFDJAA3Nr21xFldqP7N4mpk6iwdM6LmJntzgpWW2RTrbXqPm+4CsMJwLCiVFIPnEjPJel8MVzKf5q0dO9LRlY0/VuoVD83J+xOaRO5oj+XM/XSDvBqUJHqGfy+1XHZEn+OrRIddk9wZh1OBqRE38YsNDqoWfyY79v+zN0YlbeghsvJdN/NCJ5xesvIC8qeDV6FR2OxsosiQ+OTiaPOFRnaq3ycD0fB7H7dD4vM3paBispd3uKZXlIOuxCtXMmeupiwsh4Vu9/oAvpREB3/RFUw=
